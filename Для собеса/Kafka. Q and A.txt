 - Как избежать двойной отправки сообщения из producer kafka, если ack не пришел из-за сбоя сети?

**Используйте idempotent producer**
  Kafka поддерживает режим идемпотентного продюсера, который обеспечивает однократную доставку сообщений даже при
повторных попытках отправки. Для этого необходимо включить параметр `enable.idempotence=true`.
   **Плюсы:**
   - Гарантирует, что каждое сообщение будет доставлено не более одного раза.
   - Обеспечивает exactly-once семантику в пределах одного брокера.

------------------------------------------------------------------------------------------------------------------------