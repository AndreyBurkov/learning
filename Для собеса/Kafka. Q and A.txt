 - Как избежать двойной отправки сообщения из producer kafka, если ack не пришел из-за сбоя сети?

**Используйте idempotent producer**
  Kafka поддерживает режим идемпотентного продюсера, который обеспечивает однократную доставку сообщений даже при
повторных попытках отправки. Для этого необходимо включить параметр `enable.idempotence=true`.
   **Плюсы:**
   - Гарантирует, что каждое сообщение будет доставлено не более одного раза.
   - Обеспечивает exactly-once семантику в пределах одного брокера.

------------------------------------------------------------------------------------------------------------------------

 - Что нужно сделать, чтобы несколько consumer не обрабатывали одно и то же сообщение из kafka?

  Используйте одну потребительскую группу (consumer group) для всех потребителей, которые должны обрабатывать сообщения
по очереди. В этом случае Kafka гарантирует, что каждое сообщение будет обработано только одним потребителем внутри
группы.

------------------------------------------------------------------------------------------------------------------------













